## Топология

![Untitled Diagram-Page-4](https://user-images.githubusercontent.com/79700810/138058389-3c609a00-9674-41f3-8583-4db83735b289.jpg)


![image](https://user-images.githubusercontent.com/79700810/138056802-f6c4ff4b-3105-454c-ad3c-07ee7d95cdbf.png)


## Windows 
1.	Установить и настройте active directory c доменным именем ht2021.local
2.	Установить и настройте DNS сервер (прямая и обратная зона)
3.	Установить и настройте DHPC сервер с дополнительными опциями
4.	Создать группу безопасности и пользователя в подразделении ( BD, lorries, OUBD)
5.	Создайте GPO локальная группа администраторов должна входить в группу BD 
6.	Добавите в домен DEV1, DEV2

## VMware

1.	Базовая настройка   
  a.	Адресация:
    <ul>
      <li>Esxivcsa – 172.30.0.4/24
      <li>Esxi1 – 172.30.0.6/24
      <li>Esxi2 – 172.30.0.7/24
      <li>vCSA1 – 172.30.0.5/24
    </ul>


  
2.	Добавите vcsa в домен группа доменных администраторов должна иметь полный доступ
3.	Создать кластер ClusterHT хосты должны быть добавлены по именам
4.	Создайте кластер хранения DatastoreClusterHT из имеющихся дисков на хостах
5.	Создайте все необходимые Distributed switch   
  a. Сеть для vMotion
  
    <ul>
      <li>Esxi1 – 172.30.0.10/24
      <li>Esxi2 – 172.30.0.11/24
    </ul>

    b.	Сеть для DMZ
    <ul>
      <li>Esxi1 – 172.30.1.6/24
      <li>Esxi2 – 172.30.1.7/24
    </ul>
    
6.	Создайте виртуальную машину и преобразуйте ее в шаблон 

## LINUX

1.	С помощью terraform создайте виртуальные машины (k8s1, k8s2, k8s3)    
  a.	Адресация:
    <ul>
      <li>k8s1 – 172.30.1.21/24
    
      <li>k8s2 – 172.30.1.22/24
    
      <li>k8s3 – 172.30.1.23/24
    </ul>
    
    b.	ВМ должны быть доступны из сети 172.30.0.0/24
  
    c.	Конфигурационные файлы terraform сохранить в (/home/user/terraform)
  
2.	Создайте ВМ с именем nfs    

    a.	Адресация: 172.30.1.20/24
  
    b.	Установите сервисы nfs и экспортируйте директорию /srv/nfs/k8s
  
3.	С помощью kubspray разверните кластер kubernetes на ВМ (k8s1, k8s2, k8s3)

    a.	Masters: k8s1, k8s2
  
    b.	Workers: k8s3
  
    c.	Управление кластером должно быть доступно с ВМ DEV2 из под пользователя user.
  
4.	В kubernetes запустите приложение “voting app”

    a.	Приложение Vote должно быть доступно на порту “30300”
  
    b.	Приложение Result должно быть доступно на порту “30400”
  
5.	Создайте ingress для сервисов vote и result

    a.	Сервис vote должен быть доступен по адресу “vote.ht2021.local”
  
    b.	Сервис result должен быть доступен по адресу “result.ht2021.local”
  

## Monitoring

1.	Установите Prometheus в кластер kubernetes    
    b.	Установите Grafana и подключите к сервису Prometheus
    
    c.	Установите dashboards: 1860, 7249
    
    d.	Grafana должна быть доступна по адресу “grafana.ht2021.local” 

2.	Подключение к GCP
    a.	Создайте Instance в Google Cloud
    
    b.	Настройте VTI тоннель с помощью ipsec между csr и вашим instance
    
    c.	Адресация внутри тоннеля: 192.168.20.0/30
 

GitHub - dockersamples/example-voting-app: Example Docker Compose app
